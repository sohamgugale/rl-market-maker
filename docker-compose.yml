version: "3.9"
services:
  redis:
    image: redis:7-alpine
    ports: ["6379:6379"]
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5
  api:
    build: .
    ports: ["8000:8000", "8001:8001"]
    environment: [REDIS_HOST=redis]
    depends_on:
      redis:
        condition: service_healthy
    volumes: ["./models:/app/models"]
